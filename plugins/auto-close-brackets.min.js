codeInput.plugins.AutoCloseBrackets=class extends codeInput.Plugin{bracketPairs=[];bracketsOpenedStack=[];constructor(a={"(":")","[":"]","{":"}",'"':"\""}){super([]),this.bracketPairs=a}afterElementsAdded(a){let b=a.textareaElement;b.addEventListener("keydown",b=>{this.checkBackspace(a,b)}),b.addEventListener("beforeinput",b=>{this.checkBrackets(a,b)})}checkBrackets(a,b){if(0<this.bracketsOpenedStack.length&&b.data==this.bracketsOpenedStack[this.bracketsOpenedStack.length-1][0]&&b.data==a.textareaElement.value[a.textareaElement.selectionStart])a.textareaElement.selectionStart=a.textareaElement.selectionEnd+=1,this.bracketsOpenedStack.pop(),b.preventDefault();else if(b.data in this.bracketPairs){let c=this.bracketPairs[b.data];this.bracketsOpenedStack.push([c,a.textareaElement.selectionStart]),document.execCommand("insertText",!1,c),a.textareaElement.selectionStart=a.textareaElement.selectionEnd-=1}}checkBackspace(a,b){"Backspace"==b.key&&a.textareaElement.selectionStart==a.textareaElement.selectionEnd&&0<this.bracketsOpenedStack.length&&this.bracketsOpenedStack[this.bracketsOpenedStack.length-1][1]+1==a.textareaElement.selectionStart&&a.textareaElement.value[a.textareaElement.selectionStart]==this.bracketsOpenedStack[this.bracketsOpenedStack.length-1][0]&&(a.textareaElement.selectionEnd=a.textareaElement.selectionStart+1,a.textareaElement.selectionStart-=1,this.bracketsOpenedStack.pop())}};