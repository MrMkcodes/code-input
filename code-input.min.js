var codeInput={usedTemplates:{},defaultTemplate:void 0,templateQueue:{},CodeInput:class extends HTMLElement{constructor(){super()}update(a){this.value!=a&&(this.value=a),this.querySelector("textarea").value!=a&&(this.querySelector("textarea").value=a);let b=this.querySelector("pre code");"\n"==a[a.length-1]&&(a+=" "),b.innerHTML=this.escape_html(a),this.autodetect&&(b.className="",b.parentElement.className=""),this.template.includeCodeInputInHighlightFunc?this.template.highlight(b,this):this.template.highlight(b)}sync_scroll(){let a=this.querySelector("textarea"),b=this.template.preElementStyled?this.querySelector("pre"):this.querySelector("pre code");b.scrollTop=a.scrollTop,b.scrollLeft=a.scrollLeft}check_tab(a){if("Tab"!=a.key||!this.template.isCode)return;let b=this.querySelector("textarea"),c=b.value;if(a.preventDefault(),!a.shiftKey&&b.selectionStart==b.selectionEnd){let a=c.slice(0,b.selectionStart),d=c.slice(b.selectionEnd,b.value.length),e=b.selectionEnd+1;b.value=a+"\t"+d,b.selectionStart=e,b.selectionEnd=e}else{let c=b.value.split("\n"),d=0,e=b.selectionStart,f=b.selectionEnd,g=0,h=0;for(let e=0;e<c.length;e++)d+=c[e].length+1,console.log(c[e],": start",b.selectionStart,d,"&& end",b.selectionEnd,d-c[e].length),b.selectionStart<=d&&b.selectionEnd>=d-c[e].length&&(a.shiftKey?"\t"==c[e][0]&&(c[e]=c[e].slice(1),0==g&&h--,g--):(c[e]="\t"+c[e],0==g&&h++,g++));b.value=c.join("\n"),b.selectionStart=e+h,b.selectionEnd=f+g}this.update(b.value)}check_enter(a){if("Enter"!=a.key||!this.template.isCode)return;a.preventDefault();let b=this.querySelector("textarea"),c=b.value.split("\n"),d=0,e=c.length-1,f="",g=0;for(let f=0;f<c.length;f++)if(d+=c[f].length+1,b.selectionEnd<=d){e=f;break}let h=c[e].length-(d-b.selectionEnd)+1;for(let b=0;b<h&&"\t"==c[e][b];b++)g++;let i="";h!=c[e].length&&(i=c[e].substring(h),c[e]=c[e].substring(0,h));for(let b=0;b<g;b++)f+="\t";f+=i;let j=b.selectionStart,k=b.selectionEnd;c.splice(e+1,0,f),b.value=c.join("\n"),b.selectionStart=j+g+1,b.selectionEnd=k+g+1,this.update(b.value)}escape_html(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;")}get_template(){let a;return a=null==this.getAttribute("template")?codeInput.defaultTemplate:this.getAttribute("template"),a in codeInput.usedTemplates?codeInput.usedTemplates[a]:(a in codeInput.templateQueue||(codeInput.templateQueue[a]=[]),void codeInput.templateQueue[a].push(this))}setup(){this.classList.add("code-input_registered"),this.template.preElementStyled&&this.classList.add("code-input_pre-element-styled");let a=this.getAttribute("lang"),b=this.getAttribute("placeholder")||this.getAttribute("lang")||"",c=this.value||this.innerHTML||"";this.innerHTML="";let d=document.createElement("textarea");d.placeholder=b,d.value=c,d.setAttribute("spellcheck","false"),this.getAttribute("name")&&(d.setAttribute("name",this.getAttribute("name")),this.removeAttribute("name")),d.setAttribute("oninput","this.parentElement.update(this.value); this.parentElement.sync_scroll();"),d.setAttribute("onscroll","this.parentElement.sync_scroll();"),d.setAttribute("onkeydown","this.parentElement.check_tab(event); this.parentElement.check_enter(event);"),this.append(d);let e=document.createElement("code"),f=document.createElement("pre");f.setAttribute("aria-hidden","true"),f.append(e),this.append(f),this.template.isCode&&(a!=null&&""!=a?e.classList.add("language-"+a):this.autodetect=!0),this.update(c,this)}connectedCallback(){this.template=this.get_template(),this.template!=null&&this.setup()}static get observedAttributes(){return["value","placeholder","lang","template"]}attributeChangedCallback(a,b,c){if(this.isConnected)switch(a){case"value":this.update(c);break;case"placeholder":this.querySelector("textarea").placeholder=c;break;case"template":this.template=codeInput.usedTemplates[c||codeInput.defaultTemplate],this.template.preElementStyled?this.classList.add("code-input_pre-element-styled"):this.classList.remove("code-input_pre-element-styled"),this.update(this.value);case"lang":let d=this.querySelector("pre code"),e=this.querySelector("textarea");b=b.toLowerCase(),c=c.toLowerCase(),console.log("REMOVE","language-"+b),d.classList.remove("language-"+b),d.parentElement.classList.remove("language-"+b),d.classList.remove("language-none"),d.parentElement.classList.remove("language-none"),null!=c&&""!=c?(d.classList.add("language-"+c),console.log("ADD","language-"+c)):this.autodetect=!0,e.placeholder==b&&(e.placeholder=c),this.update(this.value);}}get value(){return this.getAttribute("value")}set value(a){return this.setAttribute("value",a)}get placeholder(){return this.getAttribute("placeholder")}set placeholder(a){return this.setAttribute("placeholder",a)}},registerTemplate:function(a,b){if(codeInput.usedTemplates[a]=b,a in codeInput.templateQueue)for(let c in codeInput.templateQueue[a])elem=codeInput.templateQueue[a][c],elem.template=b,elem.setup();if(null==codeInput.defaultTemplate&&(codeInput.defaultTemplate=a,void 0 in codeInput.templateQueue))for(let a in codeInput.templateQueue[void 0])elem=codeInput.templateQueue[void 0][a],elem.template=b,elem.setup()},templates:{custom(a=function(){},b=!0,c=!0,d=!1){return{highlight:a,includeCodeInputInHighlightFunc:d,preElementStyled:b,isCode:c}},prism(a){return{includeCodeInputInHighlightFunc:!1,highlight:a.highlightElement,preElementStyled:!0,isCode:!0}},hljs(a){return{includeCodeInputInHighlightFunc:!1,highlight:a.highlightElement,preElementStyled:!1,isCode:!0}},characterLimit(){return{highlight:function(a,b){let c=+b.getAttribute("data-character-limit"),d=b.escape_html(b.value.slice(0,c)),e=b.escape_html(b.value.slice(c));a.innerHTML=`${d}<mark class="overflow">${e}</mark>`,0<e.length&&(a.innerHTML+=` <mark class="overflow-msg">${b.getAttribute("data-overflow-msg")||"(Character limit reached)"}</mark>`)},includeCodeInputInHighlightFunc:!0,preElementStyled:!0,isCode:!1}},rainbowText(a=["red","orangered","orange","goldenrod","gold","green","darkgreen","navy","blue","magenta"],b=""){return{highlight:function(a,b){let c=[],d=b.value.split(b.template.delimiter);for(let e=0;e<d.length;e++)c.push(`<span style="color: ${b.template.rainbow_colors[e%b.template.rainbow_colors.length]}">${b.escape_html(d[e])}</span>`);a.innerHTML=c.join(b.template.delimiter)},includeCodeInputInHighlightFunc:!0,preElementStyled:!0,isCode:!1,rainbow_colors:a,delimiter:b}}}};customElements.define("code-input",codeInput.CodeInput);